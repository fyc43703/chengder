<!DOCTYPE html><html lang="zh-Hant"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>透明晶質獎參獎申請書 - 臺北市政府捷運工程局</title>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/stackoverflow-light.min.css">
      <style>
      html, body { margin: 0; padding: 24px; background: #FFFFFF; color: #1d1d1f; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; font-size: 15px; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
      h1, h2, h3, h4, h5, h6, b, strong { font-weight: 600; } h1 { font-weight: 700; }
      ul, ol { padding-left: 2em; margin-top: 1em; margin-bottom: 1em; } ul { list-style-type: disc; } ol { list-style-type: decimal; } li { display: list-item; }
      .hljs-container { padding: 1.5rem; border-radius: .75rem; overflow-x: auto; background: #fcfcfd; border: 1px solid #d2d2d7; }
      .text-highlight{background:linear-gradient(180deg,transparent 25%,#B3D7FF 25%,#B3D7FF 75%,transparent 75%);padding:0 2px;margin:0;display:inline;line-height:inherit;box-decoration-break:clone;-webkit-box-decoration-break:clone;border-radius:2px;font-weight:500}
      .text-highlight-multiline{background:linear-gradient(180deg,transparent 25%,#B3D7FF 25%,#B3D7FF 75%,transparent 75%);background-size:100% 1.5em;background-repeat:repeat;padding:0 2px;margin:0;display:inline;line-height:inherit;box-decoration-break:clone;-webkit-box-decoration-break:clone;border-radius:2px;font-weight:500}
      .text-highlight-error{background:linear-gradient(180deg,transparent 25%,#FFD7D8 25%,#FFD7D8 75%,transparent 75%);padding:0 2px;border-radius:2px;color:#D92525}
      .text-highlight-success{background:linear-gradient(180deg,transparent 25%,#D4EDDA 25%,#D4EDDA 75%,transparent 75%);padding:0 2px;border-radius:2px;color:#155724}
    </style></head><body><div style="max-width:1200px;margin:0 auto"><!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>透明晶質獎參獎申請書 - 臺北市政府捷運工程局</title>
    <!-- React 18 -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Prop-Types (Required for some Recharts UMD builds) -->
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    <!-- Recharts (Pinned to 2.8.0 for better UMD stability) -->
    <script src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #E0F7FA 0%, #E1F5FE 100%);
            color: #374151;
        }
        .scrollbar-custom::-webkit-scrollbar {
            width: 8px;
        }
        .scrollbar-custom::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        .scrollbar-custom::-webkit-scrollbar-thumb {
            background: #90CAF9;
            border-radius: 4px;
        }
        .scrollbar-custom::-webkit-scrollbar-thumb:hover {
            background: #64B5F6;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        .nav-item-active {
            background-color: #0288D1; /* Darker Blue */
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .nav-item-inactive {
            background-color: transparent;
            color: #E0F7FA;
        }
        .nav-item-inactive:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        .nav-item-visited {
            position: relative;
        }
        .nav-item-visited::after {
            content: '';
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background-color: #FFEB3B;
            border-radius: 50%;
        }
        /* Highlight style for search */
        .highlight {
            background-color: #FEF08A; /* Yellow-200 */
            padding: 0 2px;
            border-radius: 2px;
            font-weight: 500;
        }
        /* Chart Tooltip Customization */
        .custom-tooltip {
            background-color: rgba(255, 255, 255, 0.95);
            border: 1px solid #E1F5FE;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;
        // Destructure safely, assuming Recharts is loaded
        const { 
            LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, 
            ComposedChart, Area, PieChart, Pie, Cell 
        } = window.Recharts || {};

        // --- Inline Icon Components ---
        const Search = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        );
        const ChevronDown = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="6 9 12 15 18 9"></polyline></svg>
        );
        const ChevronUp = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="18 15 12 9 6 15"></polyline></svg>
        );
        const ArrowUp = ({ className, size = 24, strokeWidth = 2 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
        );
        const FileText = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
        );
        const Shield = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
        );
        const Award = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline></svg>
        );
        const Send = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
        );
        const BarChartIcon = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
        );

        // --- Data for Visualizations ---
        const CHART_DATA = {
            budgetTrend: [
                { year: '111年', manpower: 6, budget: 93.15 },
                { year: '112年', manpower: 7, budget: 102.75 },
                { year: '113年', manpower: 6, budget: 228.24 },
            ],
            financialStructure: [
                { name: '歲入總額', value: 294.8, fill: '#4FC3F7' },
                { name: '歲出總額', value: 309.4, fill: '#FFB74D' },
            ],
            projectScale: [
                { name: '簽約金額(億元)', value: 336.5, fill: '#81C784' },
                { name: '總資產(億元)', value: 1272, fill: '#4DB6AC' },
            ],
            achievements: [
                { name: '聯開宅(戶)', value: 2083, color: '#29B6F6' },
                { name: '開發案(處)', value: 88, color: '#FFCA28' },
                { name: '公聽會(場)', value: 39, color: '#EF5350' },
            ]
        };

        const RAW_CONTENT = {
            basic: {
                title: "基本資料",
                content: [
                    {
                        type: "table",
                        data: [
                            ["機關名稱", "臺北市政府捷運工程局"],
                            ["首長", "局長 鄭德發"],
                            ["機關地址", "臺北市中山區中山北路二段48巷7號13樓"],
                            ["機關網址", "https://www.dorts.gov.taipei"],
                            ["機關員額", "共計: 444人 (含約聘僱及臨時人員)"],
                            ["114年度總預算", "歲入、基金來源及總收入 29,486,391 千元\n歲出、基金用途及總支出 30,948,036 千元"]
                        ]
                    },
                    {
                        type: "table",
                        title: "政風人力與經費",
                        headers: ["年度", "111年", "112年", "113年"],
                        data: [
                            ["政風人員數", "6", "7", "6"],
                            ["機關投入政風經費(千元)", "93.15", "102.75", "228.24"]
                        ]
                    },
                    {
                        type: "text",
                        text: "定義說明：\n1. 政風人員數: 為機關該年底政風機構實際投入廉政工作之在職總人數，借調至其他機關或單位之人員不列入計算。\n2. 機關投入政風經費: 包含政風單位單獨編列之預算，以及編列於其他項目已支用之經費(例如:差旅費、加班費、設備費等)，但不含人事費。"
                    }
                ]
            },
            analysis: {
                title: "數據洞察", // New Tab for Analysis
                isVisual: true
            },
            intro: {
                title: "業務簡介",
                sections: [
                    {
                        title: "一、以透明與廉能，打造民眾信賴的捷運系統",
                        content: "臺北市政府捷運工程局3大業務主軸涵蓋「捷運建設」、「土地開發」及「聯開宅租售」等，為全國第一且唯一具備一條龍能力自辦監造之捷運建設機關。由於工程規模及掌控資源龐大，且攸關民眾福祉，各項工程業務如有瑕疵，不僅衝擊城市發展政策，甚至影響民眾的生活品質與安全，因此施政公開透明及確保施工品質是本局之施政核心原則。\n\n本局管理「臺北都會區大眾捷運系統土地開發基金」、「臺北市大眾捷運系統建設基金」及「臺北都會區捷運固定資產重置基金」三大基金，合計總資產1,272億餘元，預算金額龐大，備受高度關注。因此，本局在廉政風險辨識與預防措施，導入品質及風險管理機制，使各業務階段之潛在廉政風險可事前評估並加以控制。"
                    },
                    {
                        title: "二、業務項目及概況",
                        content: "臺北都會區大眾捷運系統工程建設推動始於民國64年，本局為國內捷運工程之領頭羊，具備自辦綜合規劃、財務分析、設計審查及監造作業之專業能力。\n目前已通車的路網包括文山內湖線、淡水信義線、板南線、中和新蘆線、松山新店線、環狀線第一階段等6線及代辦桃園機場捷運(市區段)、臺中捷運綠線。\n興建中路網包括信義線東延段、萬大中和樹林線一、二期及首都環狀線(包含南環、北環、東環段)等6條路線。規劃中的路網有民生汐止線及社子線計2條路線。隨著東環段順利施工後，臺北市正式邁入「捷運六線齊發 2.0」。"
                    },
                    {
                        title: "三、推動透明廉潔工作主軸",
                        content: "蔣市長以「清廉反貪是本府的核心價值」為核心，局長以誠信為本，鼓勵同仁「專業傳承、堅持信念、逐夢踏實」。本局以多元廉能治理為主軸，除強化法律遵循、E化系統管理外，並成立廉政平臺，透過公私協力跨域合作，以及落實公民參與、開放政府精神，致力達成廉能永續，誠信治理之目標。\n\n本府於113年依循廉政署透明晶質獎精神，首創「誠就永續獎」，本局榮獲首屆「誠就永續獎」之廉能政府類特優機關殊榮。"
                    }
                ]
            },
            actions: {
                title: "透明廉能作為",
                sections: [
                    {
                        title: "一、首長決心與持續作為",
                        content: "1. 專業傳承：培育專業工程團隊，確保工程品質。\n2. 堅持信念：不被外部誘惑或壓力所左右，堅守信念，不輕易妥協。\n3. 逐夢踏實：公務員生涯不一定會帶來財富，但能影響社會和國家發展。\n\n局長上任即宣示三大治理主軸，並於局級會議對各項業務之廉政風險防制做出具體裁示並追蹤列管。對內法制化，頒布543項標準作業程序(QSOP)；對外則要求廠商恪守契約。成立「南北環」及「東環段」捷運工程採購案廉政平臺，跨域溝通確保重大建設如期如質無垢完成。"
                    },
                    {
                        title: "二、資訊與行政透明",
                        content: "本局主動公開機關主要業務資訊，提供即時施工資訊及影像、工程告示牌QR Code等。官網服務中心提供300餘筆分眾資訊。針對「捷運土地開發」及「聯開宅租售」，設置「土地開發房屋網」，資訊公開透明。\n\n1. 公開事項範圍：依政府資訊公開法，主動公開法規、預算、施政計畫等。官網建置「公共工程公民參與專區」。\n2. 完整與可及度：目前88處捷運土地開發案全數透明揭露。首創友善租售平台管理2,083戶聯開宅，提供線上看屋、領標、投標等電子化作業。\n3. 外部監督：設立預算統計公開平台。施工前召開說明會，施工期間鼓勵全民督工。歷年來議會監督資料均主動提供。導入獨立第三方認證(IV&V)機制，為系統安全把關。"
                    },
                    {
                        title: "三、風險防制與課責",
                        content: "為建構完整工程全生命週期管理，本局將風險管控擴及各階段，建立風險管理資料庫E化系統。\n\n1. 捷運工程全生命週期廉政風險辨識：\n   - 規劃階段：防止個資外洩，透過專人專案系統查調。\n   - 用地取得：委託民間專業廠商查估，避免裁量濫用。\n   - 招標階段：成立廉政平臺，防止外力干擾，嚴謹執行評選。\n   - 施工階段：三級品管制度，防止偷工減料。\n   - 土地開發：權益分配明確標準化，縮減人為干預空間。\n\n2. 全國首創材料品管防禦網：從源頭管理，實施「供應商供料管理」、「材料查證與取樣」及「實驗室品質檢驗」。\n3. 廉政危機處理：從美河市及雙子星案吸取教訓，建立「投資人3階段評選」、「完善權益分配制度」及廉政平臺機制。針對南北環預算激增與臺中捷運斷軸事件，主動公開說明並邀請專家審查，化解疑慮。"
                    },
                    {
                        title: "四、廉政成效的展現",
                        content: "1. 透明行政：本局在廉能透明獎屢獲殊榮，包含「到站即到家—聯開宅房屋網」、「捷運工程首創環片生產履歷」等案獲獎。\n2. 消弭疑慮：111-113年間針對路線規劃等召開39場公聽會。用地取得堅持程序正義，確保估價公平。\n3. 突破挑戰：成功推動萬大一期等10個開發案，簽約金額達336.54億元。\n4. 實驗室E化：自行研發管理系統，數據自動計算檢核，防止人為操作，並獲TAF認證，公信力備受肯定。"
                    },
                    {
                        title: "五、廉能創新與擴散",
                        content: "1. 廉能政策創新：\n   - 潛盾環片履歷保證：比照食品履歷，首創環片生產履歷系統。\n   - 手持式金屬成分分析儀：如照妖鏡般鑑別材料，防止低規高用。\n   - 大數據防弊：分析材料試驗數據，大幅降低不合格率，節省退貨成本逾億元。\n   - 視訊查驗：遠距視訊取樣，減少不當接觸風險。\n\n2. 廉能政策擴散：\n   - 建立全方位材料品管防禦網，引領全國標準。\n   - 聯開宅租售模式獲桃園、高雄捷運取經。\n   - 捷運法規與技術標準成為中央與地方立法參考。\n   - 積極與國際交流，分享捷運治理經驗。"
                    }
                ]
            },
            future: {
                title: "未來努力方向",
                sections: [
                    {
                        title: "永續發展四大面向",
                        content: "1. 永續治理：持續智慧鐵道創新，結合AI技術進行預測性維護。以ESG為核心，導入低碳建材。\n2. 公開透明：導入科技化管理，設置電子看板顯示工地環境數據（噪音、污染），供民眾線上查詢。\n3. 風險管理：不再聚焦個案查核，轉向發掘制度性風險。開發PM系統照片自動辨識功能，防止重複計價。\n4. 廉能創新：持續投入AI技術，全面推動財產盤點E化，導入掌上型盤點機，提升資產管理透明度。"
                    }
                ]
            }
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('analysis'); // Default to Analysis for this request
            const [searchQuery, setSearchQuery] = useState('');
            const [visitedTabs, setVisitedTabs] = useState(new Set(['analysis']));
            const [isScrolled, setIsScrolled] = useState(false);
            const [rechartsLoaded, setRechartsLoaded] = useState(false);

            useEffect(() => {
                // Check if Recharts loaded correctly
                if (window.Recharts) {
                    setRechartsLoaded(true);
                } else {
                    console.error("Recharts library failed to load or is not defined on window.");
                }

                const handleScroll = () => {
                    setIsScrolled(window.scrollY > 100);
                };
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            const handleTabClick = (tabId) => {
                setActiveTab(tabId);
                setVisitedTabs(prev => new Set(prev).add(tabId));
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const scrollToTop = () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const highlightText = (text, query) => {
                if (!query) return text;
                const parts = text.split(new RegExp(`(${query})`, 'gi'));
                return parts.map((part, index) => 
                    part.toLowerCase() === query.toLowerCase() 
                        ? <span key={index} className="highlight">{part}</span> 
                        : part
                );
            };

            const renderContent = (content) => {
                 if (typeof content === 'string') {
                    // Auto-link logic
                    const urlRegex = /(https?:\/\/[^\s]+)/g;
                    const parts = content.split(urlRegex);
                    return (
                        <div className="whitespace-pre-line text-lg leading-relaxed text-gray-700">
                             {parts.map((part, i) => {
                                if (part.match(urlRegex)) {
                                    return <a key={i} href={part} target="_blank" rel="noopener noreferrer" className="text-blue-600 underline hover:text-blue-800 break-all">{highlightText(part, searchQuery)}</a>;
                                }
                                return <span key={i}>{highlightText(part, searchQuery)}</span>;
                            })}
                        </div>
                    );
                }
                return null;
            };

            const renderTable = (tableData) => (
                <div className="overflow-x-auto my-4 rounded-lg border border-blue-100 shadow-sm">
                    <table className="min-w-full bg-white text-sm text-left">
                        {tableData.headers && (
                            <thead className="bg-blue-50 text-blue-900 font-semibold">
                                <tr>
                                    {tableData.headers.map((h, i) => <th key={i} className="px-4 py-3">{h}</th>)}
                                </tr>
                            </thead>
                        )}
                        <tbody className="divide-y divide-blue-50">
                            {tableData.data.map((row, rI) => (
                                <tr key={rI} className="hover:bg-blue-50/30 transition-colors">
                                    {row.map((cell, cI) => (
                                        <td key={cI} className={`px-4 py-3 ${cI === 0 ? 'font-medium text-blue-800 bg-blue-50/50 w-1/4' : 'text-gray-600'}`}>
                                            {highlightText(cell, searchQuery)}
                                        </td>
                                    ))}
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            );

            // Analysis Dashboard Component
            const AnalysisDashboard = () => {
                if (!rechartsLoaded) {
                    return <div className="p-8 text-center text-red-500 bg-red-50 rounded-lg">圖表載入中或發生錯誤，請稍後再試。</div>;
                }

                return (
                <div className="space-y-8">
                    {/* Top KPI Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        {CHART_DATA.achievements.map((item, idx) => (
                            <div key={idx} className="glass-card p-6 rounded-2xl shadow-sm border-l-4" style={{borderLeftColor: item.color}}>
                                <h4 className="text-gray-500 text-sm font-medium mb-2">{item.name}</h4>
                                <p className="text-4xl font-bold" style={{color: item.color}}>{item.value.toLocaleString()}</p>
                            </div>
                        ))}
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        {/* 1. Mixed Chart: Personnel vs Budget */}
                        <div className="glass-card p-6 rounded-2xl shadow-sm">
                            <h3 className="text-xl font-bold text-[#01579B] mb-2 flex items-center gap-2">
                                <div className="w-1 h-6 bg-blue-400 rounded-full"></div>
                                政風資源投入趨勢分析
                            </h3>
                            <p className="text-sm text-gray-500 mb-6">診斷性分析：113年經費大幅增長 (+122%)，顯示投入轉向科技化與系統性防弊。</p>
                            <div className="h-[300px] w-full">
                                <ResponsiveContainer width="100%" height="100%">
                                    <ComposedChart data={CHART_DATA.budgetTrend}>
                                        <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#E0E0E0" />
                                        <XAxis dataKey="year" axisLine={false} tickLine={false} />
                                        <YAxis yAxisId="left" orientation="left" stroke="#0288D1" label={{ value: '經費(千元)', angle: -90, position: 'insideLeft' }} />
                                        <YAxis yAxisId="right" orientation="right" stroke="#FFB74D" label={{ value: '人力(人)', angle: 90, position: 'insideRight' }} />
                                        <Tooltip contentStyle={{ borderRadius: '8px', border: 'none', boxShadow: '0 4px 12px rgba(0,0,0,0.1)' }} />
                                        <Legend />
                                        <Bar yAxisId="right" dataKey="manpower" name="政風人力" barSize={30} fill="#FFB74D" radius={[4, 4, 0, 0]} />
                                        <Line yAxisId="left" type="monotone" dataKey="budget" name="投入經費" stroke="#0288D1" strokeWidth={3} dot={{ r: 4 }} />
                                    </ComposedChart>
                                </ResponsiveContainer>
                            </div>
                        </div>

                        {/* 2. Donut Chart: Financial Structure */}
                        <div className="glass-card p-6 rounded-2xl shadow-sm">
                            <h3 className="text-xl font-bold text-[#01579B] mb-2 flex items-center gap-2">
                                <div className="w-1 h-6 bg-blue-400 rounded-full"></div>
                                年度財務結構佔比
                            </h3>
                            <p className="text-sm text-gray-500 mb-6">描述性分析：歲入與歲出規模相當，資金流動巨大，顯示高強度監管之必要性。</p>
                            <div className="h-[300px] w-full flex justify-center">
                                <ResponsiveContainer width="100%" height="100%">
                                    <PieChart>
                                        <Pie
                                            data={CHART_DATA.financialStructure}
                                            cx="50%"
                                            cy="50%"
                                            innerRadius={60}
                                            outerRadius={100}
                                            paddingAngle={5}
                                            dataKey="value"
                                            label={({name, percent}) => `${name} ${(percent * 100).toFixed(0)}%`}
                                        >
                                            {CHART_DATA.financialStructure.map((entry, index) => (
                                                <Cell key={`cell-${index}`} fill={entry.fill} />
                                            ))}
                                        </Pie>
                                        <Tooltip />
                                        <Legend verticalAlign="bottom" height={36}/>
                                    </PieChart>
                                </ResponsiveContainer>
                            </div>
                        </div>
                    </div>

                    {/* 3. Bar Chart: Scale Comparison */}
                    <div className="glass-card p-6 rounded-2xl shadow-sm">
                        <h3 className="text-xl font-bold text-[#01579B] mb-2 flex items-center gap-2">
                            <div className="w-1 h-6 bg-blue-400 rounded-full"></div>
                            業務規模與資產量級
                        </h3>
                         <p className="text-sm text-gray-500 mb-6">指示性分析：管理三大基金總資產達 1,272 億元，簽約金額達 336.5 億元，影響力深遠。</p>
                        <div className="h-[200px] w-full">
                            <ResponsiveContainer width="100%" height="100%">
                                <BarChart
                                    layout="vertical"
                                    data={CHART_DATA.projectScale}
                                    margin={{ top: 5, right: 30, left: 40, bottom: 5 }}
                                >
                                    <CartesianGrid strokeDasharray="3 3" horizontal={true} vertical={false} />
                                    <XAxis type="number" hide />
                                    <YAxis type="category" dataKey="name" width={100} tick={{fontSize: 14}} />
                                    <Tooltip cursor={{fill: 'transparent'}} contentStyle={{ borderRadius: '8px' }} />
                                    <Bar dataKey="value" barSize={30} radius={[0, 4, 4, 0]}>
                                        {CHART_DATA.projectScale.map((entry, index) => (
                                            <Cell key={`cell-${index}`} fill={entry.fill} />
                                        ))}
                                    </Bar>
                                </BarChart>
                            </ResponsiveContainer>
                        </div>
                    </div>
                    
                    {/* Insights Summary Box */}
                    <div className="bg-yellow-50 border border-yellow-200 rounded-2xl p-6">
                        <h3 className="text-lg font-bold text-yellow-800 mb-3 flex items-center gap-2">
                             <Award size={20} /> 綜合數據洞察
                        </h3>
                        <ul className="list-disc list-inside text-gray-700 space-y-2 text-sm leading-relaxed">
                            <li><strong>資源配置轉型：</strong> 雖然政風人力維持在 6-7 人，但 113 年投入經費翻倍成長，顯示機關透過引入 AI 檢測、電子化盤點等科技手段來彌補人力缺口，提升防弊效率。</li>
                            <li><strong>高風險高監管：</strong> 捷運局經手千億級別的資產與數百億的年度預算，涉及 88 處土地開發案與 2 千多戶聯開宅，財務透明度是取得公眾信任的關鍵基石。</li>
                            <li><strong>績效具體化：</strong> 透過量化數據（如 336 億簽約金、39 場公聽會）證明其在推動建設的同時，仍能兼顧程序正義與公眾參與。</li>
                        </ul>
                    </div>
                </div>
                );
            };

            // Filter content based on active tab
            const currentData = RAW_CONTENT[activeTab];

            return (
                <div className="min-h-screen pb-20">
                    {/* Header */}
                    <header className="bg-white/90 backdrop-blur-md sticky top-0 z-50 border-b border-blue-100 shadow-sm">
                        <div className="container mx-auto px-4 py-3">
                            <div className="flex flex-col md:flex-row justify-between items-center gap-4">
                                <div className="text-center md:text-left">
                                    <h1 className="text-2xl md:text-3xl font-bold text-[#01579B] tracking-wide">
                                        透明晶質獎參獎申請書
                                    </h1>
                                    <p className="text-sm text-gray-500 mt-1">臺北市政府捷運工程局</p>
                                </div>
                                
                                <div className="flex items-center gap-4 w-full md:w-auto">
                                    <div className="relative w-full md:w-64 group">
                                        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 group-focus-within:text-blue-500 transition-colors" />
                                        <input 
                                            type="text" 
                                            placeholder="全站搜尋..." 
                                            className="w-full pl-9 pr-4 py-2 bg-blue-50/50 border border-blue-100 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-400 focus:bg-white transition-all text-sm"
                                            value={searchQuery}
                                            onChange={(e) => setSearchQuery(e.target.value)}
                                        />
                                    </div>
                                    <div className="hidden md:block text-right">
                                        <p className="text-xs text-blue-900 font-bold bg-blue-100 px-3 py-1 rounded-full">製作者：Gemini</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Navigation */}
                        <nav className="mt-2 container mx-auto px-2">
                            <div className="bg-[#29B6F6] rounded-b-2xl shadow-lg flex flex-wrap justify-center md:justify-around p-1">
                                {Object.entries(RAW_CONTENT).map(([key, section]) => {
                                    const isActive = activeTab === key;
                                    const isVisited = visitedTabs.has(key);
                                    let icon;
                                    switch(key) {
                                        case 'basic': icon = <FileText size={18} />; break;
                                        case 'analysis': icon = <BarChartIcon size={18} />; break; // New Icon
                                        case 'intro': icon = <Send size={18} />; break;
                                        case 'actions': icon = <Shield size={18} />; break;
                                        case 'future': icon = <Award size={18} />; break;
                                        default: icon = <FileText size={18} />;
                                    }

                                    return (
                                        <button
                                            key={key}
                                            onClick={() => handleTabClick(key)}
                                            className={`
                                                flex items-center gap-2 px-4 py-3 rounded-xl transition-all duration-300 m-1 flex-1 md:flex-none justify-center
                                                ${isActive ? 'nav-item-active font-bold transform scale-105' : 'nav-item-inactive font-medium'}
                                                ${!isActive && isVisited ? 'nav-item-visited' : ''}
                                            `}
                                        >
                                            {icon}
                                            <span className="text-lg tracking-widest">{section.title}</span>
                                        </button>
                                    );
                                })}
                            </div>
                        </nav>
                    </header>

                    {/* Main Content */}
                    <main className="container mx-auto px-4 py-8 max-w-5xl">
                        <div className="space-y-6 animate-fade-in-up">
                            {/* Title of current section */}
                            <div className="text-center mb-8">
                                <h2 className="text-3xl font-bold text-gray-800 inline-block relative">
                                    {currentData.title}
                                    <span className="absolute bottom-0 left-0 w-full h-2 bg-blue-200 opacity-50 -z-10 transform -rotate-1"></span>
                                </h2>
                            </div>

                            {/* Render Analysis Tab or Regular Content */}
                            {activeTab === 'analysis' ? (
                                <AnalysisDashboard />
                            ) : activeTab === 'basic' ? (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    {currentData.content.map((block, idx) => (
                                        <div key={idx} className={`glass-card p-6 rounded-2xl shadow-sm hover:shadow-md transition-shadow ${idx === 2 ? 'md:col-span-2' : ''}`}>
                                            {block.title && <h3 className="text-xl font-bold text-[#01579B] mb-4 flex items-center gap-2"><div className="w-1 h-6 bg-blue-400 rounded-full"></div>{block.title}</h3>}
                                            {block.type === 'table' ? renderTable(block) : renderContent(block.text)}
                                        </div>
                                    ))}
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    {currentData.sections && currentData.sections.map((section, idx) => (
                                        <CollapsibleSection 
                                            key={idx} 
                                            title={section.title} 
                                            searchQuery={searchQuery}
                                        >
                                            {renderContent(section.content)}
                                        </CollapsibleSection>
                                    ))}
                                </div>
                            )}
                        </div>
                    </main>

                    {/* Footer */}
                    <footer className="bg-white/60 py-6 mt-12 border-t border-blue-100">
                        <div className="container mx-auto text-center text-gray-500 text-sm">
                            <p>© 2025 臺北市政府捷運工程局 透明晶質獎參獎申請書可視化專案</p>
                        </div>
                    </footer>

                    {/* Back to Top Button */}
                    <button 
                        onClick={scrollToTop}
                        className={`fixed bottom-8 right-8 bg-[#FDD835] text-blue-900 p-3 rounded-full shadow-lg transition-all duration-300 hover:bg-[#FFF176] hover:scale-110 z-40 ${isScrolled ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10 pointer-events-none'}`}
                    >
                        <ArrowUp size={24} strokeWidth={3} />
                    </button>
                </div>
            );
        };

        // Collapsible Section Component
        const CollapsibleSection = ({ title, children, searchQuery }) => {
            const shouldExpand = searchQuery && title.toLowerCase().includes(searchQuery.toLowerCase());
            const [isOpen, setIsOpen] = useState(true);

            useEffect(() => {
                if (shouldExpand) setIsOpen(true);
            }, [shouldExpand]);

            const displayTitle = searchQuery ? (
                title.split(new RegExp(`(${searchQuery})`, 'gi')).map((part, index) => 
                    part.toLowerCase() === searchQuery.toLowerCase() 
                        ? <span key={index} className="highlight">{part}</span> 
                        : part
                )
            ) : title;

            return (
                <div className="glass-card rounded-2xl overflow-hidden shadow-sm transition-all duration-300 hover:shadow-md border-l-4 border-l-[#29B6F6]">
                    <button 
                        onClick={() => setIsOpen(!isOpen)}
                        className="w-full px-6 py-5 flex justify-between items-center text-left bg-white/50 hover:bg-blue-50/50 transition-colors"
                    >
                        <h3 className="text-xl font-bold text-[#01579B] flex items-center gap-3">
                            <span className="w-2 h-2 rounded-full bg-blue-400"></span>
                            {displayTitle}
                        </h3>
                        {isOpen ? <ChevronUp className="text-blue-400" /> : <ChevronDown className="text-gray-400" />}
                    </button>
                    
                    <div 
                        className={`transition-all duration-500 ease-in-out ${isOpen ? 'max-h-[800px] opacity-100' : 'max-h-0 opacity-0'}`}
                    >
                        <div className="px-6 pb-6 pt-2">
                            <div className="max-h-[60vh] overflow-y-auto scrollbar-custom pr-2 pl-1">
                                {children}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>

    <style>
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }
    </style>
</body>
</html></div></body></html>