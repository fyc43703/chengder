好的，這是一個很好的版面設計想法，可以讓資訊架構更清晰，使用者更容易導覽。我將根據您的要求，完全保留原始資料內容，並將網頁改為「頂部主導航 + 左側次導航 + 右側內容區」的結構。

以下是修改後的完整 HTML 檔案。您可以直接複製全部程式碼，並儲存為一個 .html 檔案來查看效果。

主要變更說明：

HTML 結構調整：

原本的 <main> 標籤被一個新的 <div class="main-container"> 取代。

在這個容器內，新增了左側邊欄 <aside id="left-sidebar"></aside> 和右側內容區 <div id="right-content"></div>。

原始的 <section> 內容被移至一個隱藏的 <div id="data-source" style="display: none;"> 中，作為動態載入內容的資料來源。

CSS 樣式更新：

增加了 Flexbox 佈局來實現兩欄式設計 (.main-container)。

為左側邊欄 (#left-sidebar) 和其連結 (#left-sidebar a) 添加了新的樣式，包括選中時的 active 狀態。

為右側內容區 (#right-content) 設置了樣式，確保內容能正常顯示並滾動。

在 @media 查詢中加入了響應式設計，當螢幕寬度小於 992px 時，左側邊欄會移動到內容區的上方，變為單欄佈局。

JavaScript 邏輯重構：

核心邏輯變更：現在點擊頂部導航連結時，JavaScript 會：

找到對應的資料來源 (<section>)。

動態地在左側邊欄中生成該區段所有的次項目連結 (原本的 collapsible-header)。

自動觸發點擊左側邊欄的第一個連結，以載入預設內容。

次導航點擊：點擊左側邊欄的連結時，會將對應的內容 (原本的 collapsible-content) 顯示在右側內容區。

搜尋功能更新：搜尋功能的點擊事件被完全重寫，現在它會：

觸發對應的頂部主導航點擊。

等待左側邊欄生成後，找到並觸發對應的次導航連結點擊。

將內容載入右側，滾動到視圖中並高亮關鍵字。

初始化：頁面載入後，會自動觸發第一個主導航的點擊事件，完成頁面的初始內容載入。

修改後的完整程式碼
code
Html
download
content_copy
expand_less

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>萬大線第一期工程進度暨時程檢討綜合分析報告</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Blue Theme Color Palette */
            --logo-blue: #00529B; 
            --light-blue: #5899D6;
            --text-color: #333;
            --bg-color: #f8f9fa;
            --nav-bg-color: rgba(255, 255, 255, 0.9);
            --header-text-color: #002d56;
            --highlight-color: yellow;
            --border-color: #dee2e6;
            --bold-green-color: #008000; /* Green color for bold text */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            line-height: 1.8;
            color: var(--text-color);
            background-color: var(--bg-color);
            background-image: linear-gradient(180deg, #fdfdff 0%, #f5f7fa 100%);
        }

        .header {
            position: sticky;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--nav-bg-color);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            z-index: 1000;
            padding: 0.5rem 1rem;
        }

        #progress-bar-container {
            width: 100%;
            height: 4px;
            background-color: transparent;
            position: absolute;
            bottom: 0;
            left: 0;
        }

        #progress-bar {
            height: 4px;
            background: var(--logo-blue);
            width: 0%;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }
        
        .header-top-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            flex-wrap: wrap;
        }
        
        .author-credit {
            font-size: 0.8rem;
            color: #555;
            position: absolute;
            top: 10px;
            right: 20px;
        }

        .title-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            flex-grow: 1;
        }

        .logo {
            height: 50px;
            width: auto;
        }

        h1.main-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--header-text-color);
            margin: 0.5rem 0;
        }

        .search-container {
            position: relative;
        }

        #search-box {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            width: 250px;
            transition: width 0.3s ease-in-out;
        }
        
        #search-box:focus {
            width: 300px;
            outline: 2px solid var(--logo-blue);
        }

        .search-results-container {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: none;
            text-align: left;
        }

        .search-results-container a {
            display: block;
            padding: 10px 15px;
            color: var(--text-color);
            text-decoration: none;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .search-results-container a:hover {
            background-color: #f5f5f5;
        }
        
        .search-results-container a small {
            display: block;
            color: #777;
            font-size: 0.8rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        nav {
            margin-top: 0.5rem;
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 10px;
            list-style: none;
            flex-wrap: wrap;
        }

        .nav-links a {
            padding: 10px 20px;
            background-color: #e9ecef;
            color: var(--logo-blue);
            text-decoration: none;
            font-size: 1.1rem;
            font-weight: 500;
            border-radius: 25px;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .nav-links a:hover {
            background-color: #dbe4f0;
            color: var(--header-text-color);
            transform: translateY(-2px);
        }

        .nav-links a.active {
            background-color: var(--logo-blue);
            color: white;
            box-shadow: 0 4px 12px rgba(0, 82, 155, 0.3);
            transform: translateY(-2px);
        }

        /* NEW LAYOUT STYLES */
        .main-container {
            display: flex;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
            gap: 2rem;
        }
        
        #left-sidebar {
            flex: 0 0 280px;
            background-color: #fff;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 45, 86, 0.07);
            border: 1px solid var(--border-color);
            align-self: flex-start; /* Keep sidebar from stretching */
        }
        
        #left-sidebar a {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--header-text-color);
            text-decoration: none;
            border-radius: 6px;
            margin-bottom: 0.5rem;
            transition: background-color 0.2s, color 0.2s;
            border-left: 4px solid transparent;
        }
        
        #left-sidebar a:hover {
            background-color: #e9ecef;
        }
        
        #left-sidebar a.active {
            background-color: #e7f5ff;
            color: var(--logo-blue);
            font-weight: 700;
            border-left: 4px solid var(--logo-blue);
        }

        #right-content {
            flex: 1;
            background-color: #fff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 45, 86, 0.07);
            border: 1px solid var(--border-color);
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Styles for content within the right panel */
        #right-content h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--header-text-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--logo-blue);
        }

        #right-content ul {
            list-style-type: none;
            padding-left: 1rem;
        }

        #right-content li {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
            position: relative;
        }
        
        #right-content li::before {
            content: '•';
            color: var(--logo-blue);
            position: absolute;
            left: 0;
            top: 0;
            font-weight: bold;
        }
        
        #right-content ul ul li::before {
            content: '○';
        }
        
        #right-content ul ul ul li::before {
            content: '■';
        }

        a {
            color: var(--logo-blue);
            text-decoration: none;
            border-bottom: 1px solid var(--light-blue);
        }

        a:hover {
            color: var(--header-text-color);
        }

        strong {
            color: var(--bold-green-color);
        }

        .highlight {
            background-color: var(--highlight-color);
            border-radius: 3px;
        }
        
        .tag {
            background-color: #e7f5ff;
            color: #1971c2;
            padding: 0.2em 0.6em;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: 500;
        }

        /* END NEW LAYOUT STYLES */

        #back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--logo-blue);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            display: none;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        #back-to-top.show {
            display: block;
            opacity: 1;
        }

        #back-to-top:hover {
            transform: scale(1.1);
        }
        
        @media (max-width: 992px) {
            .main-container {
                flex-direction: column;
            }
            #left-sidebar {
                flex-basis: auto;
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .header-top-row {
                flex-direction: column;
                gap: 10px;
            }

            .author-credit {
                position: static;
                order: -1;
                width: 100%;
                text-align: right;
                font-size: 0.7rem;
                margin-bottom: 5px;
            }

            .search-container {
                order: 3;
                width: 100%;
            }

            #search-box {
                width: 100%;
            }
            #search-box:focus {
                width: 100%;
            }
            
            .title-container {
                order: 1;
            }
            
            .logo {
                height: 40px;
            }

            h1.main-title {
                font-size: 1.5rem;
            }
            
            nav {
                order: 2;
                width: 100%;
            }

            .nav-links a {
                font-size: 1rem;
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>

    <header class="header">
        <div class="header-content">
            <div class="header-top-row">
                <span class="author-credit">製作者：陳政德</span>
                <div class="title-container">
                    <img src="https://upload.wikimedia.org/wikipedia/zh/c/c3/The_seal_of_Department_of_Rapid_Transit_Systems%2C_Taipei_City_Government_20140108.svg" alt="臺北市政府捷運工程局 局徽" class="logo">
                    <h1 class="main-title">萬大線第一期工程進度暨時程檢討綜合分析報告</h1>
                </div>
                <div class="search-container">
                    <input type="search" id="search-box" placeholder="搜尋報告內容...">
                    <div class="search-results-container" id="search-results"></div>
                </div>
            </div>
            <nav>
                <ul class="nav-links">
                    <li><a href="#section-1" class="active">引言與會議概覽</a></li>
                    <li><a href="#section-2">共通性議題之結構性分析</a></li>
                    <li><a href="#section-3">各工程處的獨特特性與分項分析</a></li>
                    <li><a href="#section-4">關鍵挑戰與進度落差分析</a></li>
                    <li><a href="#section-5">結論與未來展望</a></li>
                </ul>
            </nav>
        </div>
        <div id="progress-bar-container">
            <div id="progress-bar"></div>
        </div>
    </header>

    <div class="main-container">
        <aside id="left-sidebar"></aside>
        <div id="right-content"></div>
    </div>
    
    <div id="data-source" style="display: none;">
        <section id="section-1">
            <div class="collapsible">
                <div class="collapsible-header">會議目的與背景</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <p>本次綜合分析報告旨在深入探討臺北捷運萬大線第一期工程的當前進度、關鍵挑戰與未來時程預估。報告內容主要基於 114 年 8 月 11 日召開的「萬大線第一期工程進度及時程檢討會議」中,由第一區工程處、第二區工程處、機電系統工程處及工務管理處等核心單位所提出的簡報資料。</p>
                        <p>本次會議的召開,是依據本局 114 年 6 月 30 日第 467 次工務會報主席裁示事項,要求各單位針對局長於 113 年 12 月 4 日主持之「施工暨投入口及道路復舊時程檢討會議」及 114 年 1 月 20 日「機電系統工程安裝、測試時程檢討會議」的結論進行現況更新與彙整提報。報告將全面性地檢視土建、軌道與機電系統之間的介面整合、各標段的獨特挑戰,以及對整體完工時程的連鎖影響,以期提供一個結構清晰且具備深度洞察的工程現況全貌。</p>
                    </div>
                </div>
            </div>
            <div class="collapsible">
                <div class="collapsible-header">整體進度概況</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <p>綜合各單位報告,萬大線第一期工程在土建結構、軌道鋪設與機電設備安裝等方面均已取得實質進展。然而,工程整體時程面臨顯著挑戰,主要瓶頸集中在部分關鍵區段的機房交付延遲、共同管道施工障礙、以及土建與機電系統間的介面整合問題。其中,由第二區工程處負責的 LG05 站緩築區機房與 CQ850 標潛盾隧道段,已被明確標示為影響通車的「要徑路段」。</p>
                        <p>目前,全線送電目標與實質完工時程已根據最新進度進行重新評估,預計全線 22kV/380V 送電完成後,仍需長達 15 個月的系統測試期,方能達成實質完工。本次會議的核心,即在於精準評估延遲的影響,並探討後續的因應策略。</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="section-2">
            <div class="collapsible">
                 <div class="collapsible-header">道路復舊進度與挑戰</div>
                 <div class="collapsible-content">
                     <div class="collapsible-content-inner">
                        <p>道路復舊是民眾最有感的工程里程碑,但其進度受前期土建、共同管道工程的嚴重制約。</p>
                        <ul>
                            <li><strong>整體復舊期程與延遲情況:</strong>
                                <ul>
                                    <li>第一區工程處 (新北市段):
                                        <ul>
                                            <li>LG06 站 (連城路景平路口→134 號 ): 113 年 7 月開始,預計 115 年 7 月 31 日完成。</li>
                                            <li>LG07 站及中央避車線 (連城路):預計 115 年 7 月 15 日及 115 年 9 月 30 日完成。</li>
                                            <li>LG08 站 (連城路):預計 115 年 7 月 15 日完成。</li>
                                            <li>明挖覆蓋段 (金城路三段):預計 115 年 7 月 15 日完成。</li>
                                        </ul>
                                    </li>
                                    <li>第二區工程處 (臺北市/新北市段):
                                        <ul>
                                            <li>LG01 站 (南海路):車站及共管範圍預計 116 年 6 月完成。</li>
                                            <li>LG02 站 (南海路):車站範圍預計 115 年 6 月完成,共管預計 116 年 5 月完成,較原計畫 (114 年 9 月) 有明顯延遲。</li>
                                            <li>LG03 站 (西藏路):車站及共管範圍預計 115 年 12 月完成。</li>
                                            <li>中央避車線 (萬大路):預計 116 年 12 月完成。</li>
                                            <li>LG04 站 (萬大路):車站及非車站範圍預計 116 年 12 月完成。</li>
                                            <li>CQ850 區段標 (LG05 站、CP6):道路復舊預計 116 年 10 月 31 日完成。</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li><strong>面臨的共同挑戰:</strong>
                                <ul>
                                    <li>共同管道施工障礙: 這是造成道路復舊延遲的最主要原因之一。第二區工程處報告明確指出,南海路 (重慶南路至建中) 及西藏路 (中華路二段至萬大路) 的共同管道工程均遭遇管線障礙,需由臺北市政府新工處協助處理,此問題直接拖累了路面回填與復舊的時程。</li>
                                    <li>交通維持計畫滾動修正: 如 LG04 站因捷運七號通風井及緊急出口的替代方案變更設計,導致需重新修正交通維持計畫並與交通主管機關研議最終路型,此類行政與技術協調流程亦是時程變數。</li>
                                </ul>
                            </li>
                        </ul>
                     </div>
                 </div>
            </div>
            <div class="collapsible">
                 <div class="collapsible-header">機房交付與設備安裝現況</div>
                 <div class="collapsible-content">
                     <div class="collapsible-content-inner">
                        <p>機房的準時交付是機電系統工程進場施工的絕對前提,此環節的延遲已成為全線進度的主要瓶頸。</p>
                        <ul>
                            <li><strong>機房交付普遍延遲:</strong>
                                <ul>
                                    <li>要徑瓶頸-LG05 站: 該站三間緩築機房 (通訊號誌、設備配電室 A、不斷電系統室 A) 交付時程一再延後,從原定的 115 年 1 月 6 日,先延至 5 月 22 日,依最新工務會報資料顯示將再延至 10 月 21 日,成為影響通車時程的關鍵卡點。</li>
                                    <li>介面影響-LG06 站: 該站 B 出入口機房內部雖已完成,但機房外的土建結構及頂板交付時程,從原訂 114 年 4 月 30 日延後 4 個月至 114 年 8 月 31 日。此延遲直接導致機電系統標無法佈設電纜線槽,佈纜作業被迫停滯,嚴重影響 LG06~LG08A 區段的送電目標。</li>
                                    <li>總體情況: 工務管理處的彙整資料顯示,除 LG05 緩築區及 CP6 部分機房外,其餘各站機房多數已交付。</li>
                                </ul>
                            </li>
                            <li><strong>安裝進度:</strong>
                                <ul>
                                    <li>機電系統工程處報告指出,除了受交付延遲影響最劇的 LG05 站外,全線各車站的系統標均已進場施作,顯示機電廠商在可施工區域正積極趕工。</li>
                                </ul>
                            </li>
                        </ul>
                     </div>
                 </div>
            </div>
            <div class="collapsible">
                 <div class="collapsible-header">軌道標與投入口時程</div>
                 <div class="collapsible-content">
                     <div class="collapsible-content-inner">
                        <p>軌床交付與投入口的使用期限,直接關係到軌道鋪設與大型設備的運輸動線。</p>
                        <ul>
                            <li><strong>軌床交付現況:</strong>
                                <ul>
                                    <li>已交付區段: LG01 至 LG05 站、LG06 至 LG08A 站的軌床均已交付軌道標。</li>
                                    <li>待交付區段 (要徑):
                                        <ul>
                                            <li>LG05 至 CP6 短隧道: 預計 114 年 9 月 30 日交付。</li>
                                            <li>CP6 至 LG06 站長隧道: 預計 114 年 12 月 30 日交付。</li>
                                            <li>LG06 站隧道口: 預計 114 年 8 月 30 日交付。</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li><strong>投入口封閉時程:</strong>
                                <ul>
                                    <li>各投入口的封閉與結構完成時間是工程動線規劃的關鍵節點。
                                        <ul>
                                            <li>#1(LG01 站): 預計 114 年 10 月完成結構。</li>
                                            <li>#2(LG03-04 間中央避車線): 預計 115 年 6 月完成結構。</li>
                                            <li>北井(中央避車線): 預計 116 年 3 月完成結構。</li>
                                            <li>CP6(LG05-06 間): 預計 116 年 7 月完成結構。</li>
                                            <li>#3(LG08A 前): 預計 114 年 12 月 31 日完成結構。</li>
                                            <li>#4(LG07-08 間中避線): 預計 114 年 9 月 30 日完成結構。</li>
                                            <li>#5(機廠內): 已完成。</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                     </div>
                 </div>
            </div>
            <div class="collapsible">
                 <div class="collapsible-header">系統設備進場與安裝</div>
                 <div class="collapsible-content">
                     <div class="collapsible-content-inner">
                        <p>核心機電設備的進場與安裝是工程邁向測試階段的基礎。</p>
                        <ul>
                            <li><strong>電聯車進場:</strong>
                                <ul>
                                    <li>第一批(2~4 列車): 已於 114 年 8 月 5 日運抵港口,預計 114 年 10 月底抵達金城機廠。</li>
                                    <li>第二批(5~7 列車): 預計 114 年 11 月下旬抵達金城機廠。</li>
                                    <li>電聯車的順利抵達,為後續的動態測試提供了必要條件。</li>
                                </ul>
                            </li>
                            <li><strong>月臺門安裝:</strong>
                                <ul>
                                    <li>月臺門的安裝需配合土建與軌道工程的完成狀態。</li>
                                    <li>全線安裝的最後一站為進度最遲的 LG05 站,預計於 115 年 11 月 30 日完成安裝。</li>
                                </ul>
                            </li>
                        </ul>
                     </div>
                 </div>
            </div>
            <div class="collapsible">
                 <div class="collapsible-header">送電測試與實質完工時程</div>
                 <div class="collapsible-content">
                     <div class="collapsible-content-inner">
                        <p>送電是系統測試的起點,其時程是評估最終完工日的關鍵指標。</p>
                        <ul>
                            <li><strong>階段性送電目標:</strong>
                                <ul>
                                    <li>LG06~LG08A 區段(750VDC): 原定目標為 114 年 12 月 31 日。因機房、軌道介面延後約 4 個月,最新推估將延至 115 年 2 月,且僅 LG08A ~ LG07 站間可先行送電。</li>
                                    <li>全線(22kV/380V): 此為通車要徑的最終目標。機電系統工程處根據土建交付時程推估,預計於 116 年 5 月底可完成。</li>
                                </ul>
                            </li>
                            <li><strong>實質完工測試階段:</strong>
                                <ul>
                                    <li>工務管理處明確指出,在全線 22kV/380V 送電完成後,根據合約要求,尚需 15 個月的測試時間方能達到實質完工。此測試期程包含四個關鍵階段:
                                        <ul>
                                            <li>送電測試: 2 個月</li>
                                            <li>動態測試: 6 個月</li>
                                            <li>整合測試: 4 個月</li>
                                            <li>穩定性測試: 3 個月</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                     </div>
                 </div>
            </div>
        </section>

        <section id="section-3">
            <div class="collapsible">
                <div class="collapsible-header">第一區工程處 (負責 LG06 站至明挖覆蓋段)</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <ul>
                            <li><strong>責任範圍:</strong> 主要負責新北市中和、土城區段的土建工程,包括 LG06、LG07、LG08 站、LG08A 站及金城機廠前的明挖覆蓋段。</li>
                            <li><strong>道路復舊責任:</strong> 該處簡報詳細列出了其轄下各路段的復舊期程,集中在 115 年 7 月至 9 月間完成,時程相對明確。</li>
                            <li><strong>機房現況詳述:</strong> 第一區工程處的報告以圖文並茂的方式,清晰展示了轄內各車站的機房現況。例如,LG06 站出入口 A/B 的電池室(A)(P208)、設備變電室(A)(P207)、不斷電系統室(B)(C262)、通訊號誌設備室(C261) ; LG08 站及 LG08A 站各樓層的牽引動力配電室、設備配電室等,並詳列機房代碼。這突顯了其作為土建單位,對機電可交付空間的具體掌握。</li>
                            <li><strong>施工圍籬情況:</strong> 報告指出,至 115 年 6 月,LG06 站~LG08 站(連城路)的施工圍籬已大幅縮減,車道恢復為往土城/中和各 2 車道,顯示該區段的地面下主體工程已進入收尾階段,對交通衝擊正逐步降低。</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="collapsible">
                <div class="collapsible-header">第二區工程處 (負責 LG01 站至 LG05 站)</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <ul>
                            <li><strong>責任範圍:</strong> 負責臺北市中正、萬華區及新北市永和區的土建工程,包含 LG01 至 LG05 站、CQ850 區段標(含 CP6、CP7 聯絡通道)。此區段多位於舊市區,施工環境極其複雜。</li>
                            <li><strong>道路復舊排程複雜性:</strong>
                                <ul>
                                    <li>南海路(LG01/LG02): 復舊排程從 114 年 5 月持續至 116 年 6 月,分區、分階段、分南北側進行,體現了在交通繁忙區施工的高度複雜性。</li>
                                    <li>西藏路(LG03): 同樣採分階段施工,從 114 年 6 月至 115 年 12 月,逐步恢復路面。</li>
                                    <li>萬大路(LG04/中避線): 復舊期程長達 114 年 7 月至 116 年 12 月,涉及中央避車線、車站主體及共同管道,介面繁多。</li>
                                    <li>CQ850 區段(LG05/CP6/CP7): 復舊工程涵蓋新北市永和、中和,期程預計至 116 年 10 月。</li>
                                </ul>
                            </li>
                            <li><strong>核心挑戰———共同管道工程:</strong> 第二區工程處的核心挑戰在於共同管道的施工障礙。報告中反覆提及因管線問題需與新工處協調,這不僅是技術問題,更涉及跨單位的行政協作,是其時程管控的最大變數。</li>
                            <li><strong>軌道標現況:</strong> 簡報中提供了詳盡的軌道標鋪軌現況圖,包含各區段的道床澆置進度、鋼軌堆置區、浮動式道床施工區等,顯示軌道工程在其轄區內正依據土建交付的節奏推進。</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="collapsible">
                <div class="collapsible-header">機電系統工程處 (負責全線機電系統安裝與測試)</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <ul>
                            <li><strong>角色定位:</strong> 作為全線機電系統的整合者,其報告的核心不在於自身施工,而在於評估土建交付延遲所造成的連鎖效應。</li>
                            <li><strong>機房交付差異分析:</strong> 報告精準地指出了機房交付的「原定」、「預定」與「目前」時程差異,並量化了延遲天數。例如,LG06 站部分機房延遲-316 天,LG05 站延遲-571 天。其核心關切點在於「佈纜路徑」是否暢通,LG06 站機房外結構的延遲,正是阻斷了佈纜路徑的典型案例。</li>
                            <li><strong>軌旁交付與送電目標的關聯:</strong> 報告明確指出,支線~LG06 站軌旁延後 2.5 個月交付(114 年 5 月 31 日),直接衝擊了原訂年底 LG08A~LG06 段的送電目標。</li>
                            <li><strong>各分段施工現況評估 (從機電角度):</strong>
                                <ul>
                                    <li>LG06~LG08A 段: 要徑為「軌旁、機房設備安裝及佈纜」。報告的結論是,因介面時程延後約 4 個月,750VDC 送電目標推估延至 115 年 2 月,落後 2 個月。</li>
                                    <li>LG01~LG05 段: 該區段的關鍵前置需求是軌道標提供#2 投入口一側的軌道,供系統標運送機房設備。預計 114 年 11 月底可滿足此條件,115 年 2 月 28 日開始 22kV 佈纜。</li>
                                    <li>LG05~LG06 段 (通車要徑): 此段為全線送電的最後一哩路。報告中詳細羅列了各項前置條件的延遲情況,包括土建交付軌道標延遲、LG05 站機房交付延遲等。基於這些延遲,最終推估全線 22kV/380V 送電需至 116 年 5 月底才能完成。</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="collapsible">
                <div class="collapsible-header">工務管理處 (負責整合協調與總體管控)</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <ul>
                            <li><strong>角色定位:</strong> 作為專案的總控單位,其報告高度整合,提供全局視角。</li>
                            <li><strong>資料彙整與依據:</strong> 明確說明其資料來源為各工程處依據歷次重要會議結論修正後的最新數據,確保了報告的權威性與一致性。</li>
                            <li><strong>總體管控數據:</strong> 以簡潔的表格呈現了全線軌床交付、機房交付的總體概況,並條列出所有投入口的封閉時程,便於高層快速掌握關鍵節點。</li>
                            <li><strong>道路復舊總覽:</strong> 透過對比「113.12.4 會議預定時間」與「本次現況預估時間」,清晰地揭示了各路段復舊時程的變化,例如 LG07 站由 115 年 2 月延至 7 月,直觀地呈現了進度的落差。</li>
                            <li><strong>實質完工時程的權威預估:</strong> 整合機電處的送電預估後,工務管理處提出了「送電後尚需 15 個月測試」的關鍵結論,為專案的最終完成日期提供了明確的計算基礎。</li>
                            <li><strong>前瞻性建議事項:</strong> 該處提出的三項建議極具戰略意義:
                                <ol style="list-style-type: decimal; padding-left: 2rem; margin-top: 0.5rem;">
                                    <li><strong>要求機工處評估因應方案:</strong> 針對長達 15 個月的測試期,主動要求機電單位尋求縮短時程的可能性。</li>
                                    <li><strong>標示要徑並要求協同作戰:</strong> 明確指出 CQ850 標及緩築區機房為要徑,要求土建標趕工,並要求軌道、系統標需「協同作業」,強調團隊合作。</li>
                                    <li><strong>引進成功管理模式:</strong> 建議比照「信義東延段」的管制方式來管理五大機房的介面,試圖引入過往的成功經驗來解決當前的管理困境。</li>
                                </ol>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="section-4">
            <div class="collapsible">
                <div class="collapsible-header">主要瓶頸與相互影響</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <ul>
                            <li><strong>根本瓶頸——土建交付延遲:</strong> 整個工程進度的延遲,根源在於土建工程的交付時程落後。最顯著的兩個瓶頸點為:
                                <ul>
                                    <li>LG05 站緩築區: 該站因施工困難導致機房交付嚴重滯後,直接卡住了通車要徑路段 (LG05-LG06) 的機電安裝與後續的全線送電。</li>
                                    <li>CQ850 標潛盾隧道: 該段隧道的完工與軌床交付,是串連 LG05 站至 LG06 站的物理前提,其進度同樣是要徑。</li>
                                </ul>
                            </li>
                            <li><strong>連鎖效應 (CascadingEffect):</strong>
                                <ul>
                                    <li>土建->機電: LG06 站機房外結構頂板的延遲交付,直接導致機電系統標無法安裝電纜槽架,後續的佈纜作業完全停擺。這是一個典型的介面制約案例。</li>
                                    <li>共同管道->道路復舊: 南海路、西藏路的管線障礙未能及時排除,使得道路回填與復舊工程無法展開,直接影響民生交通與觀感。</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="collapsible">
                <div class="collapsible-header">進度預估落差分析</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <p>各單位報告中揭示了原定與現況時程的顯著落差,其原因主要可歸納為:</p>
                        <ul>
                            <li><strong>施工障礙:</strong> 如共同管道工程中未預期的管線障礙。</li>
                            <li><strong>設計變更:</strong> 如 LG04 站通風井的替代方案變更,引發了連鎖的行政審批與交維計畫調整。</li>
                            <li><strong>介面衝突:</strong> 土建、軌道、機電各標段間的施工介面未能無縫銜接,前一階段的延遲直接壓縮後續工作的預備與施工時間,導致整體時程向後推移。</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="collapsible">
                <div class="collapsible-header">介面協調的重要性</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <p>萬大線工程的複雜性,集中體現在各標段間的高度互依性。機房交付、軌床交付、投入口使用期限這三大介面,是整個專案管理的核心。土建標是「空間」的提供者,軌道標是「路徑」的建構者,而機電標則是「功能」的實現者。任何一個環節的脫鉤,都會導致後續工作無法展開。工務管理處提出比照信義東延段的管制模式,正說明現有的介面協調機制可能已不足以應對當前的複雜局面,需要更強力、更集中的管理手段介入。</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="section-5">
            <div class="collapsible">
                <div class="collapsible-header">總結</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <p>萬大線第一期工程目前正處於從土建高峰期轉向機電安裝與測試的關鍵過渡階段。雖然大部分土建結構已完成,且電聯車等核心設備已陸續到場,但工程整體進度因要徑路段 (LG05 站及 CQ850 標) 的交付延遲和普遍存在的介面協調問題而面臨嚴峻挑戰。</p>
                        <p>當前的進度評估顯示,全線 22kV/380V 的送電目標已推遲至 116 年 5 月底,之後還需 15 個月的測試期,這意味著實質完工日期將遠超原先預期。</p>
                    </div>
                </div>
            </div>
            <div class="collapsible">
                <div class="collapsible-header">未來展望與建議</div>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <p>為確保工程盡可能縮短延遲、順利推進,後續應重點關注以下幾個方面:</p>
                        <ol style="list-style-type: decimal; padding-left: 2rem; margin-top: 0.5rem;">
                            <li><strong>聚焦要徑,集中資源:</strong> 必須將管理資源與注意力高度集中在 LG05 站緩築區及 CQ850 標。除了土建標需全力趕工外,工務管理處應建立更高效的跨單位協調平台,讓軌道與系統標能以「協同作業」模式提前規劃、無縫銜接,最大化地利用有限的作業時間與空間。</li>
                            <li><strong>主動排除外部障礙:</strong> 針對共同管道的管線障礙,應提升協調層級,由捷運局高層直接與新工處等外部單位對接,設定明確的解決時程,避免問題懸而不決,持續拖累道路復舊進度。</li>
                            <li><strong>優化測試流程,爭取時間:</strong> 工務管理處已提出請機電系統工程處評估因應方案。機電單位應重新審視長達 15 個月的測試計畫,研究是否有部分測試項目可重疊進行、或通過增加資源投入來縮短時程,為專案爭取寶貴時間。</li>
                            <li><strong>強化介面管理機制:</strong> 採納工務管理處的建議,引入如「信義東延段」的成功管理模式,對五大機房等關鍵介面進行集中式、高強度的管制,確保資訊透明、決策迅速,避免問題在跨單位溝通中流失。</li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <button id="back-to-top" title="回到頂端">▲</button>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        const navLinks = document.querySelectorAll('.nav-links a');
        const leftSidebar = document.getElementById('left-sidebar');
        const rightContent = document.getElementById('right-content');
        const dataSource = document.getElementById('data-source');
        const backToTopButton = document.getElementById('back-to-top');
        const progressBar = document.getElementById('progress-bar');
        const searchBox = document.getElementById('search-box');
        const searchResultsContainer = document.getElementById('search-results');
        let searchableContent = [];

        function convertAllUrlsToLinks() {
            const contentSections = dataSource.querySelectorAll('section');
            contentSections.forEach(section => {
                 const urlRegex = /(https?:\/\/[^\s<>"'()]+)/g;
                 const walker = document.createTreeWalker(
                    section,
                    NodeFilter.SHOW_TEXT,
                    {
                        acceptNode: function(node) {
                            if (node.parentNode.nodeName === 'SCRIPT' || 
                                node.parentNode.nodeName === 'STYLE' ||
                                node.parentNode.nodeName === 'A') {
                                return NodeFilter.FILTER_REJECT;
                            }
                            if (urlRegex.test(node.nodeValue)) {
                                return NodeFilter.FILTER_ACCEPT;
                            }
                            return NodeFilter.FILTER_SKIP;
                        }
                    }
                );

                let nodes = [];
                while (walker.nextNode()) nodes.push(walker.currentNode);

                nodes.forEach(node => {
                    const text = node.nodeValue;
                    const fragment = document.createDocumentFragment();
                    let lastIndex = 0;

                    text.replace(urlRegex, (match, url, offset) => {
                        if (offset > lastIndex) {
                            fragment.appendChild(document.createTextNode(text.substring(lastIndex, offset)));
                        }
                        const a = document.createElement('a');
                        a.href = url;
                        a.textContent = url;
                        a.target = '_blank';
                        a.rel = 'noopener noreferrer';
                        fragment.appendChild(a);
                        lastIndex = offset + match.length;
                    });

                    if (lastIndex < text.length) {
                        fragment.appendChild(document.createTextNode(text.substring(lastIndex)));
                    }
                    node.parentNode.replaceChild(fragment, node);
                });
            });
        }
        
        function populateSidebarAndContent(sectionId, targetSubItemId = null) {
            const section = dataSource.querySelector(sectionId);
            if (!section) return;

            leftSidebar.innerHTML = ''; // Clear sidebar
            const collapsibles = section.querySelectorAll('.collapsible');
            
            collapsibles.forEach((collapsible, index) => {
                const header = collapsible.querySelector('.collapsible-header');
                const contentInner = collapsible.querySelector('.collapsible-content-inner');
                
                // Assign a unique ID for referencing
                const subItemId = `${sectionId.substring(1)}-sub-${index}`;
                header.id = subItemId + '-header';
                contentInner.id = subItemId + '-content';

                const link = document.createElement('a');
                link.href = `#${subItemId}`;
                link.textContent = header.textContent.trim();
                link.dataset.contentId = contentInner.id;
                link.dataset.headerId = header.id;

                link.addEventListener('click', e => {
                    e.preventDefault();
                    
                    // Update sidebar active state
                    const currentActive = leftSidebar.querySelector('a.active');
                    if(currentActive) currentActive.classList.remove('active');
                    link.classList.add('active');
                    
                    // Update right content
                    const contentToShow = document.getElementById(link.dataset.contentId);
                    if(contentToShow) {
                        // Add header to the content
                        rightContent.innerHTML = `<h2>${link.textContent}</h2>` + contentToShow.innerHTML;
                        rightContent.scrollTop = 0;
                    }
                });
                
                leftSidebar.appendChild(link);
            });
            
            // Activate the correct sub-item
            let itemToActivate;
            if (targetSubItemId) {
                itemToActivate = leftSidebar.querySelector(`a[data-header-id="${targetSubItemId}"]`);
            }
            // If no target or target not found, activate the first one
            if (!itemToActivate) {
                itemToActivate = leftSidebar.querySelector('a');
            }

            if(itemToActivate) {
                itemToActivate.click();
            } else {
                 rightContent.innerHTML = '<h2>此區段無內容</h2>';
            }
        }
        
        navLinks.forEach(link => {
            link.addEventListener('click', e => {
                e.preventDefault();
                navLinks.forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                
                const targetSectionId = link.getAttribute('href');
                populateSidebarAndContent(targetSectionId);
            });
        });

        function buildSearchIndex() {
            searchableContent = [];
            dataSource.querySelectorAll('.collapsible-header').forEach((header, index) => {
                const title = header.textContent.trim();
                const contentElement = header.nextElementSibling.querySelector('.collapsible-content-inner');
                const content = contentElement ? contentElement.innerText : '';
                const sectionId = header.closest('section').id;
                
                searchableContent.push({
                    id: `collapsible-${index}`,
                    title: title,
                    content: content,
                    sectionId: sectionId,
                    headerId: header.id // The unique ID we assigned earlier
                });
            });
        }
        
        function clearAllHighlights() {
            const highlighted = rightContent.querySelectorAll('.highlight');
            highlighted.forEach(span => {
                const parent = span.parentNode;
                if(parent) {
                    parent.replaceChild(document.createTextNode(span.textContent), span);
                    parent.normalize();
                }
            });
        }
        
        function highlightText(element, query) {
            if (!element || !query) return;
            const regex = new RegExp(`(${query.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi');
            
            const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT);
            let node;
            const nodesToReplace = [];

            while (node = walker.nextNode()) {
                if (regex.test(node.nodeValue)) {
                    nodesToReplace.push(node);
                }
            }
            
            nodesToReplace.forEach(textNode => {
                 const newContent = textNode.nodeValue.replace(regex, `<span class="highlight">$1</span>`);
                 const tempDiv = document.createElement('div');
                 tempDiv.innerHTML = newContent;
                 
                 const fragment = document.createDocumentFragment();
                 while (tempDiv.firstChild) {
                    fragment.appendChild(tempDiv.firstChild);
                 }
                 if(textNode.parentNode) {
                    textNode.parentNode.replaceChild(fragment, textNode);
                 }
            });
        }
        
        searchBox.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase().trim();
            searchResultsContainer.innerHTML = '';
            
            if (query.length < 2) {
                searchResultsContainer.style.display = 'none';
                clearAllHighlights();
                return;
            }

            const results = searchableContent.filter(item => 
                item.title.toLowerCase().includes(query) || 
                item.content.toLowerCase().includes(query)
            );
            
            if (results.length > 0) {
                results.forEach(result => {
                    const a = document.createElement('a');
                    a.href = `#${result.sectionId}`;
                    
                    const titleNode = document.createElement('strong');
                    titleNode.textContent = result.title;
                    
                    const contentSnippet = document.createElement('small');
                    const matchIndex = result.content.toLowerCase().indexOf(query);
                    const snippet = result.content.substring(Math.max(0, matchIndex - 30), matchIndex + 50);
                    contentSnippet.textContent = `...${snippet}...`;
                    
                    a.appendChild(titleNode);
                    a.appendChild(contentSnippet);
                    
                    a.addEventListener('click', (event) => {
                        event.preventDefault();
                        
                        // 1. Click the main nav link
                        const targetNavLink = document.querySelector(`.nav-links a[href="#${result.sectionId}"]`);
                        if (targetNavLink) {
                            if (!targetNavLink.classList.contains('active')) {
                                targetNavLink.click();
                            }
                        }
                        
                        // 2. Click the corresponding sidebar link
                        setTimeout(() => {
                            const targetSidebarLink = leftSidebar.querySelector(`a[data-header-id="${result.headerId}"]`);
                            if (targetSidebarLink) {
                                targetSidebarLink.click();
                                
                                // 3. Highlight the text
                                setTimeout(() => {
                                    clearAllHighlights();
                                    highlightText(rightContent, query);
                                    const firstHighlight = rightContent.querySelector('.highlight');
                                    if(firstHighlight) {
                                        firstHighlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                    }
                                }, 100);
                            }
                        }, 50); // Small delay to ensure sidebar is populated

                        searchResultsContainer.style.display = 'none';
                        searchBox.value = '';
                    });
                    
                    searchResultsContainer.appendChild(a);
                });
                searchResultsContainer.style.display = 'block';
            } else {
                 searchResultsContainer.style.display = 'none';
            }
        });
        
        document.addEventListener('click', (e) => {
            if (!searchResultsContainer.contains(e.target) && e.target !== searchBox) {
                searchResultsContainer.style.display = 'none';
            }
        });

        function handleScroll() {
            if (window.scrollY > 300) {
                backToTopButton.classList.add('show');
            } else {
                backToTopButton.classList.remove('show');
            }

            const scrollTop = document.documentElement.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrollPercent = (scrollTop / scrollHeight) * 100;
            progressBar.style.width = scrollPercent + '%';
        }

        window.addEventListener('scroll', handleScroll, { passive: true });
        
        backToTopButton.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        function initializeApp() {
            convertAllUrlsToLinks();
            // Trigger the first navigation link to populate the initial view
            const firstNavLink = document.querySelector('.nav-links a');
            if (firstNavLink) {
                populateSidebarAndContent(firstNavLink.getAttribute('href'));
            }
            buildSearchIndex();
        }

        initializeApp();
    });
    </script>

</body>
</html>
