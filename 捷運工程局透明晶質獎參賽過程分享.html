<!DOCTYPE html><html lang="zh-Hant"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>專業報告展示平台 - 透明晶質獎參賽過程分享</title>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/stackoverflow-light.min.css">
      <style>
      html, body { margin: 0; padding: 24px; background: #FFFFFF; color: #1d1d1f; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; font-size: 15px; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
      h1, h2, h3, h4, h5, h6, b, strong { font-weight: 600; } h1 { font-weight: 700; }
      ul, ol { padding-left: 2em; margin-top: 1em; margin-bottom: 1em; } ul { list-style-type: disc; } ol { list-style-type: decimal; } li { display: list-item; }
      .hljs-container { padding: 1.5rem; border-radius: .75rem; overflow-x: auto; background: #fcfcfd; border: 1px solid #d2d2d7; }
      .text-highlight{background:linear-gradient(180deg,transparent 25%,#B3D7FF 25%,#B3D7FF 75%,transparent 75%);padding:0 2px;margin:0;display:inline;line-height:inherit;box-decoration-break:clone;-webkit-box-decoration-break:clone;border-radius:2px;font-weight:500}
      .text-highlight-multiline{background:linear-gradient(180deg,transparent 25%,#B3D7FF 25%,#B3D7FF 75%,transparent 75%);background-size:100% 1.5em;background-repeat:repeat;padding:0 2px;margin:0;display:inline;line-height:inherit;box-decoration-break:clone;-webkit-box-decoration-break:clone;border-radius:2px;font-weight:500}
      .text-highlight-error{background:linear-gradient(180deg,transparent 25%,#FFD7D8 25%,#FFD7D8 75%,transparent 75%);padding:0 2px;border-radius:2px;color:#D92525}
      .text-highlight-success{background:linear-gradient(180deg,transparent 25%,#D4EDDA 25%,#D4EDDA 75%,transparent 75%);padding:0 2px;border-radius:2px;color:#155724}
    </style></head><body><div style="max-width:1200px;margin:0 auto"><!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>專業報告展示平台 - 透明晶質獎參賽過程分享</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --logo-blue: #1e3a8a; /* 品牌主色：深藍 */
            --logo-light-blue: #eff6ff; /* 淺藍背景 */
            --highlight-color: #fef08a; /* 高亮黃色 */
            --text-color: #374151;
            --strong-green: #15803d; /* 強調文字綠色 */
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            color: var(--text-color);
            background-color: #f9fafb;
        }

        /* 滾動進度條 */
        #scroll-progress-container {
            position: fixed;
            top: 70px; /* Header height (approx) */
            left: 0;
            width: 100%;
            height: 4px;
            background: transparent;
            z-index: 40;
        }

        #scroll-progress-bar {
            height: 100%;
            background: var(--logo-blue);
            width: 0%;
            transition: width 0.1s ease;
        }

        /* 頂部導航列模糊效果 */
        .backdrop-blur-md {
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        /* 內容區樣式 */
        #right-content h2 {
            position: relative;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: #111827;
        }

        #right-content h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background-color: var(--logo-blue);
            border-radius: 2px;
        }

        #right-content p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        /* 自定義列表樣式 */
        #right-content ul, #right-content ol {
            padding-left: 1rem;
            margin-bottom: 1.5rem;
        }

        #right-content ul li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.5rem;
            line-height: 1.8;
        }

        #right-content ul li::before {
            content: '•';
            color: var(--logo-blue);
            font-weight: bold;
            position: absolute;
            left: 0;
            top: 0;
        }

        #right-content ul ul li::before {
            content: '○';
            color: #6b7280;
        }

        #right-content strong {
            color: var(--strong-green);
            font-weight: 700;
        }

        /* 搜尋關鍵字高亮 */
        .highlight {
            background-color: var(--highlight-color);
            padding: 0 2px;
            border-radius: 2px;
            font-weight: 600;
        }

        /* 淡入動畫 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* 左側導航 Active 樣式 */
        .sidebar-link.active {
            background-color: var(--logo-light-blue);
            color: var(--logo-blue);
            font-weight: 700;
            border-left-color: var(--logo-blue);
        }

        /* 頂部導航 Active 樣式 */
        .nav-btn.active {
            background-color: var(--logo-blue);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .nav-btn:hover:not(.active) {
            background-color: #dbeafe; /* light blue 100 */
            transform: translateY(-1px);
        }

        /* 響應式調整 */
        @media (max-width: 991px) {
            #main-container {
                flex-direction: column;
            }
            #left-sidebar {
                width: 100%;
                margin-bottom: 1.5rem;
                position: static;
                height: auto;
            }
            #right-content {
                width: 100%;
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- 1. 頂部固定標頭 -->
    <header class="fixed top-0 w-full z-50 bg-white/90 backdrop-blur-md border-b border-gray-200 shadow-sm transition-all duration-300">
        <div class="container mx-auto px-4 h-[70px] flex items-center justify-between">
            <!-- Logo 與標題 -->
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-blue-900 rounded flex items-center justify-center text-white text-xl font-bold">
                    <i class="fa-solid fa-subway"></i>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm text-gray-500 font-medium">臺北市政府捷運工程局</span>
                    <h1 class="text-lg md:text-xl font-bold text-blue-900 leading-tight">透明晶質獎參賽過程分享</h1>
                </div>
            </div>

            <!-- 主章節導航 (Desktop) -->
            <nav class="hidden md:flex items-center gap-2" id="main-nav">
                <!-- 由 JS 動態生成 -->
            </nav>

            <!-- 搜尋框 -->
            <div class="relative w-full md:w-64 ml-4">
                <input type="text" id="search-box" placeholder="搜尋報告內容..." 
                    class="w-full pl-10 pr-4 py-2 bg-gray-100 border-none rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-blue-900 transition-all placeholder-gray-400">
                <i class="fa-solid fa-magnifying-glass absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                <!-- 搜尋結果下拉選單 -->
                <div id="search-results" class="hidden absolute top-full mt-2 w-80 right-0 bg-white rounded-lg shadow-xl border border-gray-100 max-h-96 overflow-y-auto z-50">
                    <!-- 結果由 JS 填充 -->
                </div>
            </div>
            
            <!-- Mobile Menu Button -->
            <button id="mobile-menu-btn" class="md:hidden ml-4 text-gray-600 focus:outline-none">
                <i class="fa-solid fa-bars text-xl"></i>
            </button>
        </div>

        <!-- 滾動進度條 -->
        <div id="scroll-progress-container">
            <div id="scroll-progress-bar"></div>
        </div>
        
        <!-- Mobile Navigation (Hidden by default) -->
        <div id="mobile-nav" class="hidden md:hidden bg-white border-t border-gray-100 absolute w-full shadow-lg">
            <div class="flex flex-col p-4 gap-2" id="mobile-nav-links">
                <!-- 由 JS 生成 -->
            </div>
        </div>
    </header>

    <!-- 2. 主內容容器 -->
    <main id="main-container" class="container mx-auto mt-[100px] p-4 md:p-6 flex flex-col lg:flex-row gap-8 mb-20">
        
        <!-- B. 左側次導航欄 -->
        <aside id="left-sidebar" class="lg:w-1/4 flex-shrink-0">
            <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-4 sticky top-[90px] overflow-y-auto max-h-[calc(100vh-120px)]">
                <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 pl-2">本章節內容</h3>
                <nav class="flex flex-col space-y-1" id="sub-nav">
                    <!-- JS 生成次級連結 -->
                </nav>
            </div>
        </aside>

        <!-- C. 右側內容顯示區 -->
        <section id="right-content" class="lg:w-3/4 bg-white rounded-xl shadow-sm border border-gray-100 p-6 md:p-10 min-h-[600px]">
            <!-- JS 注入內容 -->
            <div class="flex items-center justify-center h-full text-gray-400">
                <p>請選擇章節以閱讀內容</p>
            </div>
        </section>

    </main>

    <!-- 返回頂部按鈕 -->
    <button id="back-to-top" class="fixed bottom-8 right-8 bg-blue-900 text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center opacity-0 transition-opacity duration-300 hover:bg-blue-800 z-40 cursor-pointer pointer-events-none">
        <i class="fa-solid fa-arrow-up"></i>
    </button>

    <!-- 頁腳 -->
    <footer class="bg-white border-t border-gray-200 py-8 mt-auto">
        <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
            <p>&copy; 2025 臺北市政府捷運工程局 專業報告展示平台</p>
            <p class="mt-2 text-xs">資料來源：工務管理處 透明晶質獎參賽過程分享 (114年12月4日)</p>
        </div>
    </footer>

    <!-- 資料來源 (JSON 結構) -->
    <script>
        const reportData = [
            {
                id: "section1",
                title: "參賽歷程及策略",
                icon: "fa-flag",
                subsections: [
                    {
                        id: "sec1-1",
                        title: "參賽歷程",
                        content: `
                            <h2>參賽歷程與時間軸</h2>
                            <p>本局參與透明晶質獎的過程歷經長時間的籌備與多個重要節點，展現了機關上下對於廉能治理的重視。</p>
                            <ul>
                                <li><strong>113.11.04</strong>：榮獲臺北市政府誠就永續獎特優機關。</li>
                                <li><strong>113.11.21</strong>：參加透明晶質獎第一次討論會。</li>
                                <li><strong>114.01.20</strong>：召開參獎籌備第一次專案會議。</li>
                                <li><strong>114.03.18</strong>：邀請外部專家進行指導。</li>
                                <li><strong>114.04.13</strong>：完成申請書上傳系統。</li>
                                <li><strong>114.08.06</strong>：接受實地評選。</li>
                            </ul>
                            <p>參賽期間共召開 <strong>11次</strong> 總工程司以上長官主持之會議，另跨單位自行召開之會議數十次，顯示出高度的動員力。</p>
                        `
                    },
                    {
                        id: "sec1-2",
                        title: "策略研析：知己知彼",
                        content: `
                            <h2>策略研析與優勢盤點</h2>
                            <p>在參賽前，我們進行了詳盡的優勢盤點，將本局的業務績效轉化為具體的廉政亮點，核心策略包含：</p>
                            <ul>
                                <li><strong>第一 (First)</strong>：全國第一家通過國際標準認證之政府試驗機構。</li>
                                <li><strong>首創 (Original)</strong>：首創捷運聯開宅租售服務平台、首創工程界三級品管制度。</li>
                                <li><strong>唯一 (Unique)</strong>：唯一自辦監造之捷運建設機關、唯一建立材料品質全方位管理及防弊措施之工程機關。</li>
                                <li><strong>領先 (Leading)</strong>：建構全方面的材料品管防禦網，領先全國。</li>
                                <li><strong>創新 (Innovative)</strong>：利用遠距監造等技術管控廠商履約情形，如萬大線採用潛盾機滑移通過車站之創新工法。</li>
                            </ul>
                            <p>透過盤點，我們共找出 <strong>14項</strong> 具備競爭力的優勢項目。</p>
                        `
                    },
                    {
                        id: "sec1-3",
                        title: "首長決心",
                        content: `
                            <h2>首長決心：廉潔築基，捷行無阻</h2>
                            <p>首長的決心是推動廉能治理的關鍵。本局局長提出了三大核心理念：</p>
                            <ul>
                                <li><strong>專業傳承</strong>：培育專業工程團隊，確保工程品質得以延續，承接台灣軌道工程使命。</li>
                                <li><strong>堅持信念</strong>：鼓勵同仁不被外部誘惑或壓力左右，堅守信念，不輕易妥協。</li>
                                <li><strong>逐夢踏實</strong>：公務員生涯雖不致富，但能影響社會國家發展，應追求理想並踏實築夢。</li>
                            </ul>
                            <p>這不僅是口號，更透過局務會議、廉政會報等場合反覆宣示，形成機關文化。</p>
                        `
                    }
                ]
            },
            {
                id: "section2",
                title: "申請書編撰",
                icon: "fa-file-pen",
                subsections: [
                    {
                        id: "sec2-1",
                        title: "編撰核心原則",
                        content: `
                            <h2>申請書編撰核心原則</h2>
                            <p>申請書是評核的第一關，佔總分 40%。我們的編撰策略如下：</p>
                            <ul>
                                <li><strong>主題定位明確</strong>：制定廉能標語作為主軸，如「廉潔築基，捷行無阻」。</li>
                                <li><strong>依評核項目擬定架構</strong>：嚴格對照五大評核構面（首長決心、資訊透明、風險防制、廉政成效、廉能創新）分配篇幅。</li>
                                <li><strong>盤點優勢</strong>：確認三大業務核心（捷運建設、土地開發、聯開宅租售）的亮點。</li>
                                <li><strong>廉政語言加持</strong>：跳脫純工程技術語言，將業務績效轉換為「防弊」、「透明」、「課責」等廉政語言。</li>
                                <li><strong>運用 AI 輔助</strong>：利用 AI 協助校稿、潤飾標題及生成摘要，提升可讀性。</li>
                            </ul>
                        `
                    },
                    {
                        id: "sec2-2",
                        title: "三大業務亮點",
                        content: `
                            <h2>三大業務亮點呈現</h2>
                            <p>我們將申請書內容聚焦於本局核心業務的廉能展現：</p>
                            <ul>
                                <li>
                                    <strong>捷運建設</strong>：導入 E 化管理系統（53項），涵蓋全生命週期。首創材料品質全方位管理，不合格率趨近於 0。
                                </li>
                                <li>
                                    <strong>土地開發</strong>：從過去美河市案中學習，推動「權益分配標準作業規範」與「廉政平臺」。目前 88 處開發案資訊 100% 公開。
                                </li>
                                <li>
                                    <strong>聯開宅租售</strong>：作為臺北市最大房東（管理 2,083 戶），首創友善租售平台，導入虛擬帳戶系統增強資金透明度。
                                </li>
                            </ul>
                        `
                    },
                    {
                        id: "sec2-3",
                        title: "面對缺失與改進",
                        content: `
                            <h2>勇於面對過去，展現改進決心</h2>
                            <p>真正的透明不隱瞞缺失。我們在申請書中主動提及過去的挑戰（如美河市案、C1/D1 雙子星案），並詳細說明改進措施：</p>
                            <ul>
                                <li><strong>風險辨識</strong>：承認土地開發利益龐大易生官商勾結風險。</li>
                                <li><strong>防制措施</strong>：重新估價、交付仲裁、引入第三方專業審查、成立廉政平臺。</li>
                                <li><strong>改善成效</strong>：近年招商順利，無負面輿論，並獲市府頒發招商獎金。</li>
                            </ul>
                            <p>這種「浴火重生」的敘事方式，更能獲得評審委員的認同。</p>
                        `
                    }
                ]
            },
            {
                id: "section3",
                title: "簡報製作",
                icon: "fa-desktop",
                subsections: [
                    {
                        id: "sec3-1",
                        title: "簡報策略",
                        content: `
                            <h2>簡報製作策略：自行製作 vs 委外</h2>
                            <p>我們選擇<strong>自行製作</strong>簡報，原因在於：</p>
                            <ul>
                                <li><strong>內容掌握度高</strong>：可隨時配合首長演練即時調整內容，不受次數限制。</li>
                                <li><strong>節省公帑</strong>：無需支付昂貴的委外設計費。</li>
                                <li><strong>版面一致性</strong>：透過內部統籌，確保所有投影片風格統一。</li>
                            </ul>
                            <p>簡報形式採用「簡報 + 影片」，有效展現亮點並增加委員印象。</p>
                        `
                    },
                    {
                        id: "sec3-2",
                        title: "內容架構規劃",
                        content: `
                            <h2>30分鐘簡報架構</h2>
                            <p>簡報時間嚴格控制在 30 分鐘，約 30-40 頁，內容分配如下：</p>
                            <ol>
                                <li><strong>機關業務介紹 (6%)</strong>：快速帶過，聚焦核心。</li>
                                <li><strong>首長決心與透明作為 (34%)</strong>：這是簡報重點，強調首長親自帶領的廉能文化。</li>
                                <li><strong>風險防制與策進成效 (39%)</strong>：展示具體的防弊機制（如材料品管、土地開發革新）。</li>
                                <li><strong>政策創新與經驗擴散 (15%)</strong>：分享經驗至全國（如擔任其他縣市捷運顧問）。</li>
                                <li><strong>展望與永續 (6%)</strong>：結語。</li>
                            </ol>
                        `
                    },
                    {
                        id: "sec3-3",
                        title: "視覺化與故事性",
                        content: `
                            <h2>視覺化呈現與故事行銷</h2>
                            <p>為了避免簡報淪為文字堆砌，我們採取以下手法：</p>
                            <ul>
                                <li><strong>數據可視化</strong>：將不合格率下降、經費節省等數據製成圖表。</li>
                                <li><strong>小故事大道理</strong>：引用具體案例（如手持式 XRF 照妖鏡揪出低規高用材料），讓委員有記憶點。</li>
                                <li><strong>前後呼應</strong>：將「首長決心」貫穿全場，從理念到實踐，層層堆疊。</li>
                            </ul>
                        `
                    }
                ]
            },
            {
                id: "section4",
                title: "實地評核",
                icon: "fa-clipboard-check",
                subsections: [
                    {
                        id: "sec4-1",
                        title: "場地與展示規劃",
                        content: `
                            <h2>實地評核場地安排</h2>
                            <p>實地評核佔總分 60%，是決勝關鍵。我們精心規劃了動線：</p>
                            <ul>
                                <li><strong>簡報會場</strong>：安排首長簡報、亮點展示及總結會議。</li>
                                <li><strong>亮點展示區</strong>：設置實體展示攤位（如材料測試儀器、系統操作展示），由專人解說，增加互動性。</li>
                                <li><strong>資料檢閱區</strong>：將佐證資料「網頁化」呈現，方便委員快速查找，並輔以紙本檔案備查。</li>
                            </ul>
                        `
                    },
                    {
                        id: "sec4-2",
                        title: "廉能措施展示站",
                        content: `
                            <h2>設立五大廉能工作站</h2>
                            <p>我們設計了五個工作站，具體呈現捷運工程的廉能措施：</p>
                            <ol>
                                <li><strong>民意共築站</strong>：展示捷運路線規劃與用地取得的公開透明流程。</li>
                                <li><strong>品質守護站</strong>：展示材料實驗室的 TAF 認證及 E 化管理。</li>
                                <li><strong>數位防護站</strong>：展示資安防護與數位治理成果。</li>
                                <li><strong>幸福家園站</strong>：展示聯開宅的公開租售與管理。</li>
                                <li><strong>廉潔擴散站</strong>：展示經驗傳承與跨機關合作成果。</li>
                            </ol>
                        `
                    },
                    {
                        id: "sec4-3",
                        title: "成功的關鍵",
                        content: `
                            <h2>實地評核成功的關鍵</h2>
                            <p>回顧整個過程，成功的關鍵在於：</p>
                            <ul>
                                <li><strong>首長決心</strong>：首長親自參與預演、簡報，展現高度重視。</li>
                                <li><strong>全員動員</strong>：局處各單位密切合作，政風單位與業務單位無縫接軌。</li>
                                <li><strong>細節堆砌</strong>：從申請書文字到簡報配色，甚至是展示動線的演練，每一個細節都力求完美。</li>
                                <li><strong>善用工具</strong>：利用 AI 輔助效率，透過數位化工具提升展示效果。</li>
                            </ul>
                        `
                    }
                ]
            }
        ];

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            initApp();
        });

        let currentSectionId = '';
        let currentSubSectionId = '';

        function initApp() {
            renderMainNav();
            renderMobileNav();
            
            // 預設載入第一個章節
            const firstSection = reportData[0];
            activateSection(firstSection.id);
            
            // 搜尋監聽
            const searchBox = document.getElementById('search-box');
            searchBox.addEventListener('input', handleSearch);
            
            // 滾動監聽
            window.addEventListener('scroll', handleScroll);
            
            // 點擊外部關閉搜尋結果
            document.addEventListener('click', (e) => {
                if (!e.target.closest('#search-box') && !e.target.closest('#search-results')) {
                    document.getElementById('search-results').classList.add('hidden');
                }
            });

            // Mobile menu toggle
            document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                document.getElementById('mobile-nav').classList.toggle('hidden');
            });

            // Back to top
            const backToTopBtn = document.getElementById('back-to-top');
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        // 渲染頂部主導航
        function renderMainNav() {
            const navContainer = document.getElementById('main-nav');
            navContainer.innerHTML = reportData.map(section => `
                <button 
                    onclick="activateSection('${section.id}')"
                    class="nav-btn px-4 py-2 rounded-full text-sm font-medium text-gray-600 transition-all duration-200"
                    data-id="${section.id}">
                    <i class="fa-solid ${section.icon} mr-1"></i> ${section.title}
                </button>
            `).join('');
        }

        function renderMobileNav() {
            const navContainer = document.getElementById('mobile-nav-links');
            navContainer.innerHTML = reportData.map(section => `
                <button 
                    onclick="activateSection('${section.id}'); document.getElementById('mobile-nav').classList.add('hidden');"
                    class="text-left px-4 py-3 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-100"
                    data-id="${section.id}">
                    <i class="fa-solid ${section.icon} mr-2 text-blue-900"></i> ${section.title}
                </button>
            `).join('');
        }

        // 啟用主章節
        function activateSection(sectionId) {
            currentSectionId = sectionId;
            const section = reportData.find(s => s.id === sectionId);
            
            // 更新頂部導航狀態
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if (btn.dataset.id === sectionId) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // 更新左側次導航
            renderSidebar(section);

            // 預設顯示第一個子項目內容
            if (section.subsections.length > 0) {
                activateSubSection(section.subsections[0].id);
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 渲染左側次導航
        function renderSidebar(section) {
            const subNav = document.getElementById('sub-nav');
            subNav.innerHTML = section.subsections.map(sub => `
                <a href="#" 
                   onclick="event.preventDefault(); activateSubSection('${sub.id}')"
                   class="sidebar-link block py-3 px-4 text-sm text-gray-600 border-l-4 border-transparent hover:bg-gray-50 transition-all duration-200 rounded-r-md"
                   data-id="${sub.id}">
                   ${sub.title}
                </a>
            `).join('');
        }

        // 啟用子章節內容
        function activateSubSection(subId) {
            currentSubSectionId = subId;
            
            // 找出對應內容
            let contentHtml = '';
            let foundTitle = '';
            
            reportData.some(section => {
                const sub = section.subsections.find(s => s.id === subId);
                if (sub) {
                    contentHtml = sub.content;
                    foundTitle = sub.title;
                    // 如果跨主章節跳轉，需更新左側 Sidebar
                    if (section.id !== currentSectionId) {
                        currentSectionId = section.id;
                        document.querySelectorAll('.nav-btn').forEach(btn => {
                            btn.classList.toggle('active', btn.dataset.id === section.id);
                        });
                        renderSidebar(section);
                    }
                    return true;
                }
            });

            // 更新 Sidebar Active 狀態
            document.querySelectorAll('.sidebar-link').forEach(link => {
                if (link.dataset.id === subId) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });

            // 注入內容並添加動畫
            const contentContainer = document.getElementById('right-content');
            contentContainer.innerHTML = `<div class="fade-in">${contentHtml}</div>`;
        }

        // 搜尋功能
        function handleSearch(e) {
            const query = e.target.value.toLowerCase().trim();
            const resultsContainer = document.getElementById('search-results');
            
            if (query.length === 0) {
                resultsContainer.classList.add('hidden');
                return;
            }

            const results = [];
            
            reportData.forEach(section => {
                section.subsections.forEach(sub => {
                    // 簡單的文字匹配 (可移除 HTML 標籤後搜尋)
                    const plainText = sub.content.replace(/<[^>]*>/g, '');
                    if (plainText.toLowerCase().includes(query) || sub.title.toLowerCase().includes(query)) {
                        results.push({
                            sectionTitle: section.title,
                            subTitle: sub.title,
                            subId: sub.id,
                            snippet: getSnippet(plainText, query)
                        });
                    }
                });
            });

            if (results.length > 0) {
                resultsContainer.innerHTML = results.map(res => `
                    <div class="p-3 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-0" 
                         onclick="jumpToSearchResult('${res.subId}', '${query}')">
                        <div class="text-xs text-blue-800 font-bold mb-1">${res.sectionTitle} > ${res.subTitle}</div>
                        <div class="text-xs text-gray-500 line-clamp-2">${res.snippet}</div>
                    </div>
                `).join('');
                resultsContainer.classList.remove('hidden');
            } else {
                resultsContainer.innerHTML = `<div class="p-4 text-center text-sm text-gray-500">找不到相符內容</div>`;
                resultsContainer.classList.remove('hidden');
            }
        }

        function getSnippet(text, query) {
            const index = text.toLowerCase().indexOf(query);
            const start = Math.max(0, index - 20);
            const end = Math.min(text.length, index + query.length + 30);
            return '...' + text.substring(start, end) + '...';
        }

        // 跳轉至搜尋結果並高亮
        function jumpToSearchResult(subId, query) {
            activateSubSection(subId);
            document.getElementById('search-results').classList.add('hidden');
            
            // 延遲執行高亮，等待內容渲染完成
            setTimeout(() => {
                const contentDiv = document.querySelector('#right-content div');
                if (contentDiv) {
                    highlightText(contentDiv, query);
                }
            }, 100);
        }

        function highlightText(element, query) {
            // 簡易的高亮實作：遍歷所有 text node
            const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, false);
            const nodesToReplace = [];
            
            while(walker.nextNode()) {
                const node = walker.currentNode;
                if (node.nodeValue.toLowerCase().includes(query)) {
                    nodesToReplace.push(node);
                }
            }

            nodesToReplace.forEach(node => {
                const span = document.createElement('span');
                const regex = new RegExp(`(${query})`, 'gi');
                span.innerHTML = node.nodeValue.replace(regex, '<span class="highlight">$1</span>');
                node.parentNode.replaceChild(span, node);
            });
        }

        // 滾動處理 (進度條 & Back to top)
        function handleScroll() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            
            document.getElementById('scroll-progress-bar').style.width = scrolled + "%";

            // Back to top button visibility
            const btn = document.getElementById('back-to-top');
            if (winScroll > 300) {
                btn.classList.remove('opacity-0', 'pointer-events-none');
                btn.classList.add('opacity-100', 'cursor-pointer');
            } else {
                btn.classList.add('opacity-0', 'pointer-events-none');
                btn.classList.remove('opacity-100', 'cursor-pointer');
            }
        }
    </script>
</body>
</html></div></body></html>